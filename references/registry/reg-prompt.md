# Prompt质量检查项注册表

> **唯一权威定义**：所有Prompt质量检查项在此定义，其他文件只能引用ID。
> **适用范围**：ALL = 所有类型 | S = Skill | P = Plugin | M = Memory | A = Agentic内容

## 检查项列表

### 约束规范 (P-0xx)

| ID | 检查项 | 要求 | 严重性 | 适用 |
|----|--------|------|--------|------|
| P-001 | 详尽约束 | 有明确长度限制 (或示范性示例暗示) | Severe | ALL |
| P-002 | 范围边界 | 边界已传达 (明确 "do not" 或清晰上下文) | Severe | ALL |
| P-003 | 禁止捏造 | 事实内容有 "Never fabricate..." 指令 | Severe | ALL |
| P-004 | 歧义处理 | 不明确情况有指令 (澄清或解释) | Warning | ALL |
| P-005 | 无AI已知内容 | 不解释标准概念 | Warning | ALL |
| P-006 | 接地指令 | 不确定声明有 "Based on context" | Warning | ALL |
| P-007 | 自检步骤 | 高风险输出有验证步骤 | Warning | ALL |
| P-008 | 输出模式 | 结构化输出有 JSON 结构或格式规范 | Warning | ALL |

### 停止条件 (P-1xx)

| ID | 检查项 | 要求 | 严重性 | 适用 |
|----|--------|------|--------|------|
| P-101 | 停止条件存在 | 多阶段内容在阶段门有明确停止条件 | Severe | A |
| P-102 | 停止条件强度 | 使用强语言 + 禁止 | Severe | A |
| P-103 | 阶段门条件 | 明确的阶段触发条件 | Severe | A |

### 约束集中 (P-2xx)

| ID | 检查项 | 要求 | 严重性 | 适用 |
|----|--------|------|--------|------|
| P-201 | 约束集中 | 关键约束在 ≤3 处，最好在顶部 | Severe | ALL |
| P-202 | 约束位置 | 关键约束在文档前 20% | Severe | A |
| P-203 | 禁止语言强度 | 关键约束使用强禁止语言 | Warning | ALL |

### 工具使用 (P-3xx)

| ID | 检查项 | 要求 | 严重性 | 适用 |
|----|--------|------|--------|------|
| P-301 | 工具优先 | 新鲜/用户特定数据优先使用工具而非内部知识 | Warning | A |
| P-302 | 工具并行化 | 并行化独立读取操作 | Info | A |
| P-303 | 写入确认 | 写入后重述：什么改变、在哪里、验证 | Warning | A |

### Agentic更新 (P-4xx)

| ID | 检查项 | 要求 | 严重性 | 适用 |
|----|--------|------|--------|------|
| P-401 | 简短更新 | 仅主要阶段时 1-2 句简短更新 | Warning | A |
| P-402 | 具体结果 | 每次更新有具体结果 | Warning | A |
| P-403 | 无任务扩展 | 不扩展超出用户请求；标记可选工作 | Warning | A |
| P-404 | 无叙述 | 避免 "出声思考" | Info | A |

### 长上下文 (P-5xx)

| ID | 检查项 | 要求 | 严重性 | 适用 |
|----|--------|------|--------|------|
| P-501 | 内部大纲 | >10k tokens 时先产生内部大纲 | Warning | ALL |
| P-502 | 约束重述 | 回答前重述用户约束 | Warning | ALL |
| P-503 | 节锚定 | 声明锚定到具体节，带引用 | Warning | ALL |

### 结构化输出 (P-6xx)

| ID | 检查项 | 要求 | 严重性 | 适用 |
|----|--------|------|--------|------|
| P-601 | 模式定义 | 提供 JSON 形状/结构 | Severe | ALL |
| P-602 | 字段区分 | 必需 vs 可选标记 | Warning | ALL |
| P-603 | 空值处理 | 缺失 → null，不猜测 | Warning | ALL |
| P-604 | 返回前重扫 | 检查遗漏字段 | Info | ALL |

### 结构化标签 (P-7xx)

| ID | 检查项 | 要求 | 严重性 | 适用 |
|----|--------|------|--------|------|
| P-701 | 标签存在 | 复杂prompt有角括号标签 | Warning | ALL |
| P-702 | 标签内容匹配 | 详尽标签有长度规则，非范围 | Warning | ALL |
| P-703 | 无语法错误 | 标签正确闭合 | Warning | ALL |
| P-704 | 无冗余标签 | 无重复目的标签 | Info | ALL |
| P-705 | 无未闭合标签 | 所有标签都闭合 | Fatal | ALL |
| P-706 | 标签名无空格 | 标签名无空格 | Severe | ALL |
| P-707 | snake_case命名 | 标签使用 snake_case | Warning | ALL |

### 反模式 (P-8xx)

| ID | 检查项 | 要求 | 严重性 | 适用 |
|----|--------|------|--------|------|
| P-801 | 无填充短语 | 无 "Take a deep breath" 等 | Warning | ALL |
| P-802 | 无模糊详尽 | 无 "Be concise" 无量化约束 | Warning | ALL |
| P-803 | 无绝对声明 | 无不合格的 "Always/Never/Guaranteed" | Warning | ALL |
| P-804 | 无最大化语言 | 无 "Analyze everything" | Warning | ALL |
| P-805 | 无矛盾指令 | 无冲突指令 | Severe | ALL |
| P-806 | 无分散约束 | 约束不在 >3 处 | Severe | ALL |
| P-807 | 无弱停止条件 | 停止语言不弱 | Severe | A |
| P-808 | 无范围漂移 | 无功能蔓延 | Severe | A |

### 意图传达预检 (P-9xx)

| ID | 检查项 | 要求 | 严重性 | 适用 |
|----|--------|------|--------|------|
| P-901 | 示范性示例 | 内容是否有暗示预期行为/格式的示例？ | - | ALL |
| P-902 | 上下文清晰 | AI能否从周围上下文推断预期行为？ | - | ALL |
| P-903 | 阈值测试 | <30% 会误解无明确约束吗？ | - | ALL |

## 执行方法

```
1. 预检：检查意图是否已通过示例/上下文传达
2. 检查约束：详尽、范围、禁止捏造、停止条件
3. 检查结构：集中、位置、标签
4. 检查工具使用：优先、并行、确认
5. 检查反模式：填充、模糊、矛盾
6. 输出：「Prompt质量: 约束N/M问题; 结构K问题; 反模式L个」
```

## 严重性判定

| 条件 | 严重性 |
|------|--------|
| AI无法从示例/上下文推断 | 按上述严重性 |
| AI可以推断 | 不是问题 |
| <30% 会误解 | 不是问题 |
